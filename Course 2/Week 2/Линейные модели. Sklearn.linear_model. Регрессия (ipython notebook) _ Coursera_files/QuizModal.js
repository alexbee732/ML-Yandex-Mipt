define("bundles/quiz/components/QuizModal",["require","exports","module","react","js/lib/coursera.react-intl","bundles/ui/components/Modal","bundles/phoenix/components/Time","bundles/phoenix/components/TimeDuration","i18n!nls/quiz","css!./__styles__/QuizModal"],function(require,exports,module){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _defaults(e,o){for(var n=Object.getOwnPropertyNames(o),t=0;t<n.length;t++){var a=n[t],i=Object.getOwnPropertyDescriptor(o,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var n,u,f=require("react"),t=_interopRequireDefault(f),i=require("js/lib/coursera.react-intl"),p=require("bundles/ui/components/Modal"),l=_interopRequireDefault(p),r=require("bundles/phoenix/components/Time"),s=_interopRequireDefault(r),d=require("bundles/phoenix/components/TimeDuration"),o=_interopRequireDefault(d),m=require("i18n!nls/quiz"),e=_interopRequireDefault(m);require("css!./__styles__/QuizModal");var a={closeQuiz:{title:e["default"]("Are you sure?"),cancel:e["default"]("Stay"),confirm:e["default"]("Leave")},timeExpired:{title:e["default"]("Time's up!"),cancel:e["default"]("Discard"),confirm:e["default"]("Continue")},timedAttempt:{title:e["default"]("This is a timed quiz"),cancel:e["default"]("Cancel"),confirm:e["default"]("Continue")},lastAttempt:{title:e["default"]("Last Attempt"),cancel:e["default"]("Cancel"),confirm:e["default"]("Start Quiz")},unansweredQuestions:{title:e["default"]("Unanswered Questions"),cancel:e["default"]("Go Back"),confirm:e["default"]("Submit")},saveFailed:{title:e["default"]("Save Failed"),cancel:e["default"]("--"),confirm:e["default"]("Okay")},"default":{title:e["default"]("Please confirm"),cancel:e["default"]("Cancel"),confirm:e["default"]("Confirm")}},c=(u=n=function(n){function QuizModal(){var a,e,i;_classCallCheck(this,QuizModal);for(var o=arguments.length,u=Array(o),t=0;o>t;t++)u[t]=arguments[t];return a=e=_possibleConstructorReturn(this,n.call.apply(n,[this].concat(u))),e.needsCancelButton=function(){return["timeExpired","saveFailed"].indexOf(e.props.type)<0},i=a,_possibleConstructorReturn(e,i)}return _inherits(QuizModal,n),QuizModal.prototype.buildTitle=function buildTitle(){var n=this.props,o=n.type,u=n.lockedTimeLeft,l=a[o]?a[o].title:a["default"].title;if("lastAttempt"===o&&u>0){var r=t["default"].createElement(s["default"],{time:Date.now()+u,format:"MMMM D ["+e["default"]("at")+"] h:mm A"});return t["default"].createElement(i.FormattedMessage,{message:e["default"]("{titleText} until {time}"),titleText:l,time:r})}return l},QuizModal.prototype.buildCloseQuizBody=function buildCloseQuizBody(){var a=this.props,n=a.timeLimit,u=a.isAutoSaveActive,l=a.hasAttemptLimit,r=u?e["default"]("Your progess has been saved. Be sure to come back and submit your answers to get your score."):e["default"]("Closing will discard your work so far."),o="";return n>0&&(o=l?e["default"]("Your timer won't stop if you leave the quiz without submitting\n          and you will still consume 1 attempt."):e["default"]("Your timer won't stop if you leave the quiz without submitting.")),t["default"].createElement(i.FormattedMessage,{message:e["default"]("{saveTip} {timerTip} Are you sure you want to leave this quiz?"),saveTip:r,timerTip:o})},QuizModal.prototype.buildTimeExpiredBody=function buildTimeExpiredBody(){return t["default"].createElement("span",null,e["default"]("You've reached the time limit for this quiz. Your quiz will be automatically submitted for grading."))},QuizModal.prototype.buildTimedAttemptBody=function buildTimedAttemptBody(){var a=this.props,n=a.timeLimit,u=a.hasAttemptLimit,l=t["default"].createElement(o["default"],{duration:n,showPrecise:!0});return t["default"].createElement(i.FormattedMessage,{message:e["default"]("Are you sure you are ready to start the quiz? You will be given {duration} to complete it.\n          {showConsumeText, select, true {Once you reach the time limit, you will consume one attempt.} false {}}"),duration:l,showConsumeText:!!u})},QuizModal.prototype.buildLastAttemptBody=function buildLastAttemptBody(){var a=this.props,n=a.timeLimit,u=a.lockedTimeLeft;return t["default"].createElement("div",null,u>0?t["default"].createElement(i.FormattedMessage,{message:e["default"]("This is your last attempt for the next {lockDuration}."),lockDuration:t["default"].createElement(o["default"],{duration:u,showPrecise:!0})}):t["default"].createElement("span",null,e["default"]("This is your last attempt.")),n>0&&t["default"].createElement(i.FormattedMessage,{message:e["default"](" You will have {limitDuration} to complete it."),limitDuration:t["default"].createElement(o["default"],{duration:n,showPrecise:!0})}),t["default"].createElement("span",null,e["default"](" Make sure you've studied the material before you start.")))},QuizModal.prototype.buildUnansweredQuestionsBody=function buildUnansweredQuestionsBody(){return t["default"].createElement("div",null,e["default"]("There are some questions that you didn't answer.  Do you want to go back and answer them or\n            continue and submit your current answers?"))},QuizModal.prototype.buildSaveFailedBody=function buildSaveFailedBody(){return t["default"].createElement("div",null,t["default"].createElement("p",null,e["default"]("Our attempts to save your progress on this quiz are failing.\n             Please refresh your browser immediately so you don't lose more work!")),t["default"].createElement("p",null,e["default"]("This can be caused by having multiple windows open to the same quiz.\n             Make sure you're viewing the quiz in only one window!")))},QuizModal.prototype.buildBody=function buildBody(){var a=this.props.type,e=null;if("closeQuiz"===a?e=this.buildCloseQuizBody():"timeExpired"===a?e=this.buildTimeExpiredBody():"timedAttempt"===a?e=this.buildTimedAttemptBody():"lastAttempt"===a?e=this.buildLastAttemptBody():"unansweredQuestions"===a?e=this.buildUnansweredQuestionsBody():"saveFailed"===a&&(e=this.buildSaveFailedBody()),null!==e)return t["default"].createElement("div",{className:"body body-1-text"},t["default"].createElement("div",{className:"modal-body-text"},e),this.buildControls());return t["default"].createElement("noscript",null)},QuizModal.prototype.buildControls=function buildControls(){var i=this.props,e=i.type,o=i.onRequestCancel,n=i.onRequestConfirm;return t["default"].createElement("div",{className:"controls"},this.needsCancelButton()&&t["default"].createElement("button",{className:"cancel passive",onClick:o},a[e]?a[e].cancel:a["default"].cancel),t["default"].createElement("button",{className:"confirm primary",onClick:n},a[e]?a[e].confirm:a["default"].confirm))},QuizModal.prototype.render=function render(){var e=this.props,a=e.isOpen,i=e.onRequestCancel;return t["default"].createElement(l["default"],{isOpen:a,onRequestClose:i,title:this.buildTitle(),size:"large",className:"rc-QuizModal"},this.buildBody())},QuizModal}(t["default"].Component),n.propTypes={type:t["default"].PropTypes.oneOf(["closeQuiz","timeExpired","timedAttempt","lastAttempt","unansweredQuestions","saveFailed"]),isOpen:t["default"].PropTypes.bool,onRequestCancel:t["default"].PropTypes.func.isRequired,onRequestConfirm:t["default"].PropTypes.func,timeLimit:t["default"].PropTypes.number,lockedTimeLeft:t["default"].PropTypes.number,isAutoSaveActive:t["default"].PropTypes.bool,hasAttemptLimit:t["default"].PropTypes.bool},u);module.exports=c});